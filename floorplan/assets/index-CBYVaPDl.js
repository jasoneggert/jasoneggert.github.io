const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./webglRenderer-D9AstZTl.js","./three-DPD25GbA.js"])))=>i.map(i=>d[i]);
!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const e={},t=function(t,r,n){let o=Promise.resolve();if(r&&r.length>0){const t=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),a=s?.nonce||s?.getAttribute("nonce");o=Promise.allSettled(r.map((r=>{if(r=function(e,t){return new URL(e,t).href}(r,n),r in e)return;e[r]=!0;const o=r.endsWith(".css"),s=o?'[rel="stylesheet"]':"";if(!!n)for(let e=t.length-1;e>=0;e--){const n=t[e];if(n.href===r&&(!o||"stylesheet"===n.rel))return}else if(document.querySelector(`link[href="${r}"]${s}`))return;const i=document.createElement("link");return i.rel=o?"stylesheet":"modulepreload",o||(i.as="script"),i.crossOrigin="",i.href=r,a&&i.setAttribute("nonce",a),document.head.appendChild(i),o?new Promise(((e,t)=>{i.addEventListener("load",e),i.addEventListener("error",(()=>t(new Error(`Unable to preload CSS for ${r}`))))})):void 0})))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return o.then((e=>{for(const t of e||[])"rejected"===t.status&&s(t.reason);return t().catch(s)}))},r=await t((()=>import("./imageProcessor-B6wYvlgg.js")),[],import.meta.url),n=await t((()=>import("./webglRenderer-D9AstZTl.js")),__vite__mapDeps([0,1]),import.meta.url),o=await t((()=>import("./floorplanParser-Dra7fZBN.js")),[],import.meta.url),{ErrorHandler:s,validateFile:a,showStatus:i,updateProgress:l}=await t((async()=>{const{ErrorHandler:e,validateFile:t,showStatus:r,updateProgress:n}=await import("./utilities-BcUNtL0B.js");return{ErrorHandler:e,validateFile:t,showStatus:r,updateProgress:n}}),[],import.meta.url);class d{#e=null;#t=null;#r=null;#n=null;#o=!1;constructor(){this.#s(),this.#a(),this.#i()}async#s(){try{this.#e=new r.default,this.#t=new n.default("webgl-canvas"),this.#r=new o.default,await this.#t.initialize()}catch(e){s.handleError(e,"Failed to initialize application components")}}#a(){const e=document.getElementById("floorplan-upload"),t=document.getElementById("process-btn");e?.addEventListener("change",this.#l.bind(this));const r=document.querySelector(".upload-container");r?.addEventListener("dragover",this.#d.bind(this)),r?.addEventListener("drop",this.#c.bind(this)),r?.addEventListener("dragenter",this.#u.bind(this)),r?.addEventListener("dragleave",this.#h.bind(this)),t?.addEventListener("click",this.#g.bind(this)),this.#m(),this.#p()}#m(){const e=document.getElementById("reset-view"),t=document.getElementById("toggle-wireframe"),r=document.getElementById("toggle-lighting"),n=document.getElementById("wall-height"),o=document.getElementById("wall-height-value");e?.addEventListener("click",(()=>{this.#t?.resetCamera()})),t?.addEventListener("click",(()=>{const e=this.#t?.toggleWireframe();t.textContent=e?"Solid":"Wireframe",t.setAttribute("aria-pressed",e.toString())})),r?.addEventListener("click",(()=>{const e=this.#t?.toggleLighting();r.textContent=e?"No Lighting":"Lighting",r.setAttribute("aria-pressed",e.toString())})),n?.addEventListener("input",(e=>{const t=parseFloat(e.target.value);o.textContent=`${t.toFixed(1)}m`,this.#t?.updateWallHeight(t)}))}#p(){const e=document.getElementById("webgl-canvas");e?.addEventListener("keydown",(e=>{if(!this.#t)return;const{key:t}=e;let r=!1;switch(t){case"ArrowUp":this.#t.rotateCamera(0,-.1),r=!0;break;case"ArrowDown":this.#t.rotateCamera(0,.1),r=!0;break;case"ArrowLeft":this.#t.rotateCamera(-.1,0),r=!0;break;case"ArrowRight":this.#t.rotateCamera(.1,0),r=!0;break;case"+":case"=":this.#t.zoomCamera(.9),r=!0;break;case"-":this.#t.zoomCamera(1.1),r=!0;break;case"r":case"R":this.#t.resetCamera(),r=!0}r&&e.preventDefault()}))}async#l(e){const t=e.target.files?.[0];t&&await this.#w(t)}#d(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"}#u(e){e.preventDefault(),e.currentTarget.classList.add("drag-over")}#h(e){e.preventDefault(),e.currentTarget.contains(e.relatedTarget)||e.currentTarget.classList.remove("drag-over")}async#c(e){e.preventDefault(),e.currentTarget.classList.remove("drag-over");const t=e.dataTransfer.files;t.length>0&&await this.#w(t[0])}async#w(e){try{const t=a(e);if(!t.isValid)throw new Error(t.error);await this.#f(e);const r=document.getElementById("process-btn");r&&(r.disabled=!1,this.#n=e),i('File uploaded successfully. Click "Process Floor Plan" to continue.',"success")}catch(t){s.handleError(t,"Failed to process uploaded file")}}async#f(e){return new Promise(((t,r)=>{const n=new FileReader;n.onload=e=>{const n=document.querySelector(".preview-container"),o=document.getElementById("preview-image");o&&n?(o.src=e.target.result,n.hidden=!1,t()):r(new Error("Preview elements not found"))},n.onerror=()=>r(new Error("Failed to read image file")),n.readAsDataURL(e)}))}async#g(){if(!this.#n||this.#o)return;this.#o=!0;const e=document.getElementById("process-btn"),t=e?.querySelector(".btn-text"),r=e?.querySelector(".btn-spinner");try{e&&(e.disabled=!0),t&&(t.textContent="Processing..."),r&&(r.hidden=!1),i("Analyzing floor plan image...","info"),l(10);const n=await this.#e.processFloorPlan(this.#n);l(40),i("Detecting walls, doors, and windows...","info");const o=await this.#r.parseFloorPlan(n);l(70),i("Generating 3D model...","info"),await this.#t.generateModel(o),l(100),i("3D model generated successfully!","success");const s=document.querySelector(".viewer-section");s&&s.scrollIntoView({behavior:"smooth"})}catch(n){s.handleError(n,"Failed to process floor plan")}finally{this.#o=!1,e&&(e.disabled=!1),t&&(t.textContent="Process Floor Plan"),r&&(r.hidden=!0),setTimeout((()=>{const e=document.getElementById("progress-bar");e&&(e.hidden=!0)}),2e3)}}#i(){window.addEventListener("unhandledrejection",(e=>{s.handleError(e.reason,"An unexpected error occurred"),e.preventDefault()}));let e=0,t=0;window.addEventListener("error",(r=>{const n=Date.now();if(n-t>5e3&&(e=0),e>=5)return;if(!r.error)return;if(!["ResizeObserver loop completed with undelivered notifications","ResizeObserver loop limit exceeded","Non-Error promise rejection captured","Script error"].some((e=>r.message?.includes(e)))){e++,t=n;try{s.handleError(r.error,"An unexpected error occurred")}catch(o){}}}));const r=document.getElementById("webgl-canvas");r?.addEventListener("webglcontextlost",(e=>{e.preventDefault(),s.handleError(new Error("WebGL context lost"),"Graphics context was lost. Please refresh the page.")}))}}const c=async()=>{try{if(!("fetch"in window))throw new Error("This browser does not support required features. Please use a modern browser.");const e=document.createElement("canvas");if(!(e.getContext("webgl2")||e.getContext("webgl")))throw new Error("WebGL is not supported in this browser. 3D viewing requires WebGL support.");new d;0}catch(e){s.handleError(e,"Failed to initialize application")}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c();
