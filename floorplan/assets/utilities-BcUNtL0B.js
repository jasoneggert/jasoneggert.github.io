const e={MAX_FILE_SIZE:10485760,SUPPORTED_FORMATS:["image/png","image/jpeg","image/jpg"],SUPPORTED_EXTENSIONS:[".png",".jpg",".jpeg"],STATUS_TYPES:{SUCCESS:"success",ERROR:"error",INFO:"info",WARNING:"warning"},ANIMATION_DURATION:300,STATUS_TIMEOUT:5e3,MIN_IMAGE_WIDTH:100,MIN_IMAGE_HEIGHT:100,MAX_IMAGE_WIDTH:4096,MAX_IMAGE_HEIGHT:4096};class r{static#e=[];static#r=100;static#t=!1;static#i=0;static#s=0;static#o=5;static#n=5e3;static#a=!1;static handleError(e,r="An unexpected error occurred",t=""){if(this.#t)return;const i=Date.now();if(i-this.#s>this.#n&&(this.#i=0),!(this.#i>=this.#o)){this.#i++,this.#s=i,this.#t=!0;try{e||(e=new Error("Unknown error occurred"));const i=e.message||"Unknown error",s=e.stack||"No stack trace available",o={timestamp:(new Date).toISOString(),error:i,stack:s,userMessage:r,context:t,type:this.#c(e)};this.#l(o),this.#d(r,o.type),this.#u(o)}catch(s){}finally{this.#t=!1}}}static#c(e){if(!e||"string"!=typeof e.message)return"runtime";const r=e.message.toLowerCase();return r.includes("network")||r.includes("fetch")||r.includes("timeout")||r.includes("connection")?"network":r.includes("webgl")||r.includes("canvas")||r.includes("rendering")||r.includes("graphics")?"graphics":r.includes("file")||r.includes("image")||r.includes("upload")||r.includes("format")?"file":r.includes("validation")||r.includes("invalid")||r.includes("required")||r.includes("format")?"validation":"runtime"}static#l(e){this.#e.push(e),this.#e.length>this.#r&&this.#e.shift()}static#d(r,t){try{const i=document.getElementById("error-modal"),s=document.getElementById("error-message"),o=document.getElementById("error-close");if(!i||!s||!o)return;const n=this.#E(t);s.innerHTML=`${n} ${r}`,i.classList.add("show"),i.hidden=!1,i.setAttribute("aria-hidden","false"),setTimeout((()=>{try{o.focus()}catch(e){}}),100);const a=()=>{try{document.activeElement===o&&o.blur(),i.classList.remove("show"),i.hidden=!0,i.setAttribute("aria-hidden","true")}catch(e){}};o.onclick=a,i.querySelector(".modal-backdrop")?.addEventListener("click",a),"graphics"!==t&&"network"!==t&&setTimeout(a,e.STATUS_TIMEOUT)}catch(i){}}static#E(e){return{network:"🌐",graphics:"🖥️",file:"📁",validation:"⚠️",runtime:"❌"}[e]||"❌"}static#u(e){}static getErrorLog(){return[...this.#e]}static clearErrorLog(){this.#e.length=0}}function t(r){try{if(!r)return{isValid:!1,error:"No file provided"};if(r.size>e.MAX_FILE_SIZE){return{isValid:!1,error:`File size exceeds ${e.MAX_FILE_SIZE/1048576}MB limit. Please choose a smaller file.`}}if(!e.SUPPORTED_FORMATS.includes(r.type))return{isValid:!1,error:"Unsupported file format. Please use PNG, JPG, or JPEG images."};const t=r.name.toLowerCase().substring(r.name.lastIndexOf("."));return e.SUPPORTED_EXTENSIONS.includes(t)?0===r.size?{isValid:!1,error:"File appears to be empty. Please choose a valid image file."}:{isValid:!0}:{isValid:!1,error:"Invalid file extension. Please use .png, .jpg, or .jpeg files."}}catch(t){return{isValid:!1,error:"Error validating file. Please try again."}}}function i(r,t=e.STATUS_TYPES.INFO,i=e.STATUS_TIMEOUT){const o=document.getElementById("processing-status");o&&(o.className=`status-message status-${t}`,o.textContent=r,o.hidden=!1,o.setAttribute("aria-live","polite"),t!==e.STATUS_TYPES.ERROR&&i>0&&setTimeout((()=>{s()}),i))}function s(){const e=document.getElementById("processing-status");e&&(e.hidden=!0,e.setAttribute("aria-live","off"))}function o(r,t=""){const s=document.getElementById("progress-bar"),o=s?.querySelector(".progress-fill");if(!s||!o)return;const n=Math.max(0,Math.min(100,r));s.hidden=!1,o.style.width=`${n}%`,o.setAttribute("aria-valuenow",n.toString()),t&&i(t,e.STATUS_TYPES.INFO,0),n>=100&&setTimeout((()=>{s.hidden=!0}),1e3)}export{e as CONFIG,r as ErrorHandler,s as hideStatus,i as showStatus,o as updateProgress,t as validateFile};
